#!/usr/bin/env bash

source "${BASH_SOURCE%/*}/shared.sh"

require_installer package-manager

dotheader "Setting up Hammerspoon..."
brew_cask_install hammerspoon --appdir=/Applications

function setup_vim_mode_spoon_from_local() {
  local code_dir=$HOME/code
  local source_dir=$code_dir/VimMode.spoon
  local symlink_destination=$HOME/.hammerspoon/Spoons/VimMode.spoon

  mkdir -p "$code_dir"

  if [ ! -d $source_dir ]; then
    dotsay "@blue@b[[+ cloning development copy of VimMode.spoon ]]"
    git clone https://github.com/dbalatero/VimMode.spoon "$source_dir"
  else
    dotsay "+ VimMode.spoon dev copy already checked out"
  fi

  if [ -f $symlink_destination ]; then
    dotsay "@blue@b[[+ symlinking development copy of VimMode.spoon ]]"
    ln -s "$source_dir" "$symlink_destination"
  else
    dotsay "+ VimMode.spoon already installed to Hammerspoon"
  fi
}

symlink_dotfile hammerspoon ~/.hammerspoon
setup_vim_mode_spoon_from_local
